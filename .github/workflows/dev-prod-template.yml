name: SQL DevProd TempDeployment

on:
  workflow_dispatch:
    inputs:
      sql_script:
        description: 'Path to the SQL script'
        required: true
        type: string

jobs:
  DeveloperEnv:
    uses: ./.github/workflows/sql-deploy-template.yml
    with:
      sql_script: ${{ github.event.inputs.sql_script }}
      environment_name: development
    secrets:
      SQL_SERVER_URL: ${{ secrets.SQL_SERVER_HOST }}
      SQL_USERNAME: ${{ secrets.SQL_SERVER_USER }}
      SQL_PASSWORD: ${{ secrets.SQL_SERVER_PASSWORD }}


  ProductionEnv:
    needs: deploy-dev
    uses: ./.github/workflows/setup-sql-main.yml
    with:
      sql_script: ${{ github.event.inputs.sql_script }}
      environment_name: production
    secrets:
      SQL_SERVER_URL: ${{ secrets.PROD_SQL_SERVER_URL }}
      SQL_USERNAME: ${{ secrets.PROD_SQL_USER }}
      SQL_PASSWORD: ${{ secrets.PROD_SQL_PASSWORD }}
      
